# -*- coding: utf-8 -*-
"""Final_output.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1-jAKkeZDC59KreMe93Q_HV1lQvCD4VXb
"""

from openpyxl import Workbook, load_workbook
from openpyxl.drawing.image import Image as XLImage
from google.colab import files

wb = Workbook()
wb.remove(wb.active)

# Add data sheets
for file_name, sheet_name in [
    ('Average_Rating_by_Price_Range.xlsx', 'Avg Rating by Price'),
    ('Rating_Color_with_Highest_Average_Rating.xlsx', 'Top Rating Color'),
    ('model_comparison.xlsx', 'Model Compare'),
    ('model_performance.xlsx', 'Model Performance')
]:
    temp_wb = load_workbook(file_name)
    temp_ws = temp_wb.active
    new_ws = wb.create_sheet(title=sheet_name)
    for row in temp_ws.iter_rows(values_only=True):
        new_ws.append(row)

# Add charts
for img_file, sheet_name in [
    ('Table_Booking_Availability.png', 'Table Booking'),
    ('Online_Delivery_Availability.png', 'Online Delivery'),
    ('Average_Rating_by_Price_Range.png', 'Avg Rating by Price'),
    ('Model_Performance_Comparison.png', 'Model Perf Compare'),
    ('Restaurant_Clusters.png', 'Restaurant Clusters'),
    ('Distribution_of_Ratings.png', 'Rating Distribution'),
    ('Count_of_Rating_Categories.png', 'Rating Category Count'),
    ('Top_10_Cuisines_by_Average_Rating.png', 'Top Cuisines by Rating'),
    ('Top_10_Cities_by_Average_Rating.png', 'Top Cities by Rating')
]:
    ws = wb.create_sheet(title=sheet_name)
    img = XLImage(img_file)
    ws.add_image(img, "B2")

# Save and download
wb.save("restaurant_dashboard_summary.xlsx")
files.download("restaurant_dashboard_summary.xlsx")